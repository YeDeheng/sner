O	0	12	Incrementing
O	13	14	a
O	15	22	counter
O	22	23	,
O	24	30	simple
O	31	33	as
O	34	36	it
O	37	40	may
O	41	43	be
O	43	44	,
O	45	49	just
O	50	53	has
O	54	56	to
O	57	59	be
O	60	61	a
O	62	73	transaction
O	74	77	...
O	78	85	meaning
O	85	86	,
O	87	89	it
O	90	93	can
O	94	98	lock
O	99	102	out
O	103	106	the
O	107	112	whole
O	113	115	DB
O	116	119	for
O	120	126	longer
O	127	131	than
O	132	137	makes
O	138	143	sense
O	143	144	!

O	145	146	-
O	146	147	)
O	148	150	It
O	151	154	can
O	155	161	easily
O	162	164	be
O	165	168	the
O	169	179	bottleneck
O	180	183	for
O	184	187	the
O	188	193	whole
O	194	200	system
O	200	201	.

O	202	204	If
O	205	208	you
O	209	213	need
O	214	224	rigorously
O	225	230	exact
O	231	237	counts
O	238	241	but
O	242	247	don't
O	248	252	need
O	253	257	them
O	258	260	to
O	261	263	be
O	264	273	instantly
O	274	284	up-to-date
O	284	285	,
O	286	288	my
O	289	297	favorite
O	298	306	approach
O	307	309	is
O	310	312	to
O	313	319	append
O	320	323	the
O	324	333	countable
O	334	345	information
O	346	348	to
O	349	350	a
O	351	354	log
O	355	356	(
O	356	365	switching
O	366	370	logs
O	371	373	as
O	374	379	often
O	380	382	as
O	383	389	needed
O	390	393	for
O	394	398	data
O	399	408	freshness
O	409	417	purposes
O	417	418	)
O	418	419	.

O	420	424	Once
O	425	426	a
O	427	430	log
O	431	433	is
O	434	440	closed
O	441	442	(
O	442	446	with
O	447	456	thousands
O	457	459	of
O	460	469	countable
O	470	476	events
O	477	479	in
O	480	482	it
O	482	483	)
O	483	484	,
O	485	486	a
O	487	493	script
O	494	497	can
O	498	502	read
O	503	505	it
O	506	509	and
O	510	516	update
O	517	520	all
O	521	525	that
O	526	527	'
O	528	529	s
O	530	536	needed
O	537	539	in
O	540	541	a
O	542	548	single
O	549	560	transaction
O	561	563	--
O	564	569	maybe
O	570	573	not
O	574	583	intuitive
O	583	584	,
O	585	588	but
O	589	593	much
O	594	600	faster
O	601	605	than
O	606	615	thousands
O	616	618	of
O	619	625	single
O	626	631	locks
O	631	632	.

O	633	637	Then
O	638	643	there
O	644	645	'
O	646	647	s
O	648	662	extremely-fast
O	663	671	counters
O	672	676	that
O	677	680	are
O	681	685	only
O	686	699	statistically
O	700	708	accurate
O	709	711	--
O	712	715	but
O	716	721	since
O	722	725	you
O	726	731	don't
O	732	735	say
O	736	740	that
O	741	745	such
O	746	757	imprecision
O	758	760	is
O	761	771	acceptable
O	771	772	,
O	773	776	I'm
O	777	780	not
O	781	786	going
O	787	789	to
O	790	797	explain
O	798	802	them
O	803	805	in
O	806	810	more
O	811	816	depth
O	816	817	.

O	818	823	There
O	824	827	are
O	828	831	two
O	832	838	really
O	839	843	easy
O	844	848	ways
O	849	850	:

O	851	856	Parse
O	857	859	it
O	860	863	out
O	864	866	of
O	867	871	your
O	872	875	web
O	876	880	logs
O	881	883	in
O	884	889	batch
O	889	890	.

O	891	894	Run
O	895	898	the
O	899	903	hits
O	904	911	through
O	912	922	beanstalkd
O	923	925	or
O	926	934	gearmand
O	935	938	and
O	939	943	have
O	944	945	a
O	946	952	worker
O	953	955	do
O	956	959	the
O	960	964	hard
O	965	970	stuff
O	971	973	in
O	974	975	a
O	976	986	controlled
O	987	990	way
O	990	991	.

O	992	998	Option
O	999	1000	1
O	1001	1006	works
O	1007	1011	with
O	1012	1025	off-the-shelf
O	1026	1031	tools
O	1031	1032	.

O	1033	1039	Option
O	1040	1041	2
O	1042	1050	requires
O	1051	1055	just
O	1056	1057	a
O	1058	1061	bit
O	1062	1064	of
O	1065	1076	programming
O	1076	1077	,
O	1078	1081	but
O	1082	1087	gives
O	1088	1091	you
O	1092	1101	something
O	1102	1108	closer
O	1109	1111	to
O	1112	1120	realtime
O	1121	1128	updates
O	1129	1136	without
O	1137	1144	causing
O	1145	1148	you
O	1149	1151	to
O	1152	1156	fall
O	1157	1161	over
O	1162	1166	when
O	1167	1170	the
O	1171	1178	traffic
O	1179	1185	spikes
O	1186	1187	(
O	1187	1191	such
O	1192	1194	as
O	1195	1201	you'll
O	1202	1206	find
O	1207	1209	in
O	1210	1214	your
O	1215	1221	direct
O	1222	1227	mysql
O	1228	1232	case
O	1232	1233	)
O	1233	1234	.

O	1235	1238	Not
O	1239	1243	sure
O	1244	1246	if
O	1247	1249	it
O	1250	1251	'
O	1252	1253	s
O	1254	1256	up
O	1257	1261	your
O	1262	1267	alley
O	1267	1268	,
O	1269	1272	but
B-Plat	1273	1282	AppEngine
O	1283	1285	is
O	1286	1287	a
O	1288	1294	pretty
O	1295	1299	nice
O	1300	1308	platform
O	1309	1311	to
O	1312	1317	build
O	1318	1320	on
O	1320	1321	.

O	1322	1326	Some
O	1327	1333	sample
O	1334	1338	code
O	1339	1342	you
O	1343	1346	can
O	1347	1350	use
O	1351	1353	to
O	1354	1359	build
O	1360	1361	a
O	1362	1369	counter
O	1370	1375	using
O	1376	1381	their
O	1382	1391	DataStore
O	1392	1395	and
O	1396	1408	transactions
O	1409	1411	is
O	1412	1421	described
O	1422	1426	here
O	1427	1428	:
O	1429	1501	http://code.google.com/appengine/docs/python/datastore/transactions.html
O	1501	1502	.

O	1503	1505	If
O	1506	1514	accuracy
O	1515	1517	is
O	1518	1527	important
O	1527	1528	,
O	1529	1532	you
O	1533	1536	can
O	1537	1539	do
O	1540	1542	it
O	1543	1551	slightly
O	1552	1558	slower
O	1559	1563	with
B-PL	1564	1569	MySql
O	1570	1573	...
O	1574	1580	create
O	1581	1582	a
O	1583	1587	HEAP
O	1588	1589	/
O	1590	1596	Memory
O	1597	1602	table
O	1603	1605	to
O	1606	1611	store
O	1612	1616	your
O	1617	1624	counter
O	1625	1631	values
O	1631	1632	.

O	1633	1638	These
O	1639	1640	a
O	1641	1650	in-memory
O	1651	1657	tables
O	1658	1662	that
O	1663	1666	are
O	1667	1676	blazingly
O	1677	1681	fast
O	1681	1682	.

O	1683	1686	You
O	1687	1690	can
O	1691	1696	write
O	1697	1700	the
O	1701	1705	data
O	1706	1710	into
O	1711	1712	a
O	1713	1719	normal
O	1720	1725	table
O	1726	1728	at
O	1729	1738	intervals
O	1738	1739	.

O	1740	1745	Based
O	1746	1748	on
O	1749	1752	the
O	1753	1756	app
O	1757	1763	engine
O	1764	1769	ideas
O	1769	1770	,
O	1771	1774	you
O	1775	1780	could
O	1781	1784	use
B-Fram	1785	1793	memcache
O	1794	1796	as
O	1797	1798	a
O	1799	1808	temporary
O	1809	1814	store
O	1815	1818	for
O	1819	1823	your
O	1824	1831	counter
O	1831	1832	.

O	1833	1845	Incrementing
O	1846	1847	a
B-Fram	1848	1856	memcache
O	1857	1864	counter
O	1865	1867	is
O	1868	1874	faster
O	1875	1879	than
O	1880	1885	using
O	1886	1889	the
B-PL	1890	1895	MySql
O	1896	1900	heap
O	1901	1907	tables
O	1908	1909	(
O	1909	1910	I
O	1911	1916	think
O	1916	1917	)
O	1917	1918	.

O	1919	1923	Once
O	1924	1929	every
O	1930	1934	five
O	1935	1937	or
O	1938	1941	ten
O	1942	1949	seconds
O	1949	1950	,
O	1951	1954	you
O	1955	1960	could
O	1961	1965	read
O	1966	1969	the
B-Fram	1970	1978	memcache
O	1979	1986	counter
O	1987	1990	and
O	1991	1996	write
O	1997	2001	that
O	2002	2008	number
O	2009	2013	into
O	2014	2018	your
O	2019	2021	DB
O	2021	2022	.

O	2023	2026	You
O	2027	2032	could
O	2033	2037	take
O	2038	2042	your
O	2043	2052	webserver
O	2053	2054	'
O	2055	2056	s
O	2057	2063	Access
O	2064	2067	log
O	2068	2069	(
O	2069	2075	Apache
O	2076	2077	:
O	2078	2088	access.log
O	2088	2089	)
O	2090	2093	and
O	2094	2102	evaluate
O	2103	2105	it
O	2106	2110	time
O	2111	2114	and
O	2115	2120	again
O	2121	2122	(
O	2122	2129	cronjob
O	2129	2130	)
O	2131	2133	in
O	2134	2138	case
O	2139	2142	you
O	2143	2145	do
O	2146	2149	not
O	2150	2154	need
O	2155	2157	to
O	2158	2162	have
O	2163	2166	the
O	2167	2171	data
O	2172	2174	at
O	2175	2179	hand
O	2180	2182	at
O	2183	2186	the
O	2187	2192	exact
O	2193	2199	moment
O	2200	2202	in
O	2203	2207	time
O	2208	2212	when
O	2213	2220	someone
O	2221	2227	visits
O	2228	2232	your
O	2233	2237	site
O	2237	2238	.

O	2239	2246	Usually
O	2246	2247	,
O	2248	2251	the
O	2252	2262	access.log
O	2263	2265	is
O	2266	2275	generated
O	2276	2282	anyway
O	2283	2286	and
O	2287	2295	contains
O	2296	2299	the
O	2300	2309	requested
O	2310	2318	resource
O	2319	2321	as
O	2322	2326	well
O	2327	2329	as
O	2330	2334	time
O	2334	2335	,
O	2336	2340	date
O	2341	2344	and
O	2345	2348	the
O	2349	2353	user
O	2354	2355	'
O	2356	2357	s
O	2358	2360	IP
O	2360	2361	.

O	2362	2366	This
O	2367	2370	way
O	2371	2374	you
O	2375	2377	do
O	2378	2381	not
O	2382	2386	have
O	2387	2389	to
O	2390	2395	route
O	2396	2399	all
O	2400	2406	trafic
O	2407	2414	through
O	2415	2416	a
O	2417	2427	php-script
O	2427	2428	.

O	2429	2433	Lean
O	2433	2434	,
O	2435	2439	mean
O	2440	2448	counting
O	2449	2456	machine
O	2456	2457	.

O	2458	2461	You
O	2462	2465	can
O	2466	2469	use
B-Fram	2470	2475	Redis
O	2476	2477	-
O	2478	2481	its
O	2482	2486	very
O	2487	2491	fast
O	2492	2501	key-value
O	2502	2509	storage
O	2510	2514	with
O	2515	2522	support
O	2523	2526	for
O	2527	2533	atomic
O	2534	2544	increments
O	2544	2545	.

O	2546	2548	If
O	2549	2553	need
O	2554	2558	will
O	2559	2564	arise
O	2565	2567	--
O	2568	2574	counts
O	2575	2579	data
O	2580	2585	could
O	2586	2588	be
O	2589	2597	splitted
O	2598	2605	between
O	2606	2614	multiple
O	2615	2622	servers
O	2623	2629	easily
O	2629	2630	.

O	2631	2635	I've
O	2636	2640	done
O	2641	2650	something
O	2651	2655	very
O	2656	2663	similar
O	2663	2664	,
O	2665	2667	on
O	2668	2669	a
O	2670	2677	similar
O	2678	2683	scale
O	2684	2685	(
O	2685	2693	multiple
O	2694	2701	servers
O	2701	2702	,
O	2703	2711	hundreds
O	2712	2714	of
O	2715	2722	domains
O	2722	2723	,
O	2724	2731	several
O	2732	2740	thousand
O	2741	2745	hits
O	2746	2749	per
O	2750	2754	hour
O	2754	2755	)
O	2756	2759	and
O	2760	2763	log
O	2764	2768	file
O	2769	2777	analysis
O	2778	2781	was
O	2782	2792	definitely
O	2793	2796	the
O	2797	2800	way
O	2801	2803	to
O	2804	2806	go
O	2806	2807	.

O	2808	2809	(
O	2809	2811	It
O	2812	2816	also
O	2817	2824	checked
O	2825	2828	hit
O	2829	2834	rates
O	2834	2835	,
O	2836	2844	weighted
O	2845	2849	them
O	2850	2852	by
O	2853	2857	file
O	2858	2862	type
O	2862	2863	,
O	2864	2867	and
O	2868	2879	blacklisted
O	2880	2882	IP
O	2883	2892	addresses
O	2893	2895	at
O	2896	2899	the
O	2900	2908	firewall
O	2909	2911	if
O	2912	2916	they
O	2917	2921	were
O	2922	2928	making
O	2929	2932	too
O	2933	2937	many
O	2938	2946	requests
O	2947	2948	;
O	2949	2952	its
O	2953	2961	intended
O	2962	2969	purpose
O	2970	2973	was
O	2974	2976	to
O	2977	2987	auto-block
O	2988	2991	bad
O	2992	2996	bots
O	2996	2997	,
O	2998	3001	not
O	3002	3004	to
O	3005	3009	just
O	3010	3012	be
O	3013	3014	a
O	3015	3022	counter
O	3022	3023	,
O	3024	3027	but
O	3028	3036	counting
O	3037	3040	was
O	3041	3043	an
O	3044	3053	essential
O	3054	3059	piece
O	3060	3062	of
O	3063	3065	it
O	3065	3066	.
O	3066	3067	)

O	3068	3070	No
O	3071	3082	performance
O	3083	3089	impact
O	3090	3092	on
O	3093	3096	the
O	3097	3100	web
O	3101	3107	server
O	3108	3115	process
O	3116	3122	itself
O	3122	3123	,
O	3124	3129	since
O	3130	3132	it
O	3133	3134	'
O	3135	3136	s
O	3137	3140	not
O	3141	3146	doing
O	3147	3150	any
O	3151	3161	additional
O	3162	3166	work
O	3167	3172	there
O	3172	3173	,
O	3174	3177	and
O	3178	3181	you
O	3182	3187	could
O	3188	3194	easily
O	3195	3202	publish
O	3203	3223	periodically-updated
O	3224	3227	hit
O	3228	3234	counts
O	3235	3237	by
O	3238	3247	injecting
O	3248	3252	them
O	3253	3257	into
O	3258	3261	the
O	3262	3266	site
O	3267	3268	'
O	3269	3270	s
O	3271	3279	database
O	3280	3285	every
O	3286	3292	minute
O	3293	3294	/
O	3295	3296	5
O	3297	3304	minutes
O	3305	3306	/
O	3307	3310	100
O	3311	3315	hits
O	3316	3317	/
O	3318	3326	whatever
O	3327	3334	without
O	3335	3341	having
O	3342	3344	to
O	3345	3349	lock
O	3350	3353	the
O	3354	3362	relevant
O	3363	3366	row
O	3367	3368	/
O	3369	3374	table
O	3375	3376	/
O	3377	3385	database
O	3386	3387	(
O	3387	3396	depending
O	3397	3399	on
O	3400	3403	the
O	3404	3411	locking
O	3412	3421	mechanism
O	3422	3424	in
O	3425	3428	use
O	3428	3429	)
O	3430	3432	on
O	3433	3438	every
O	3439	3442	hit
O	3442	3443	.

O	3444	3451	Without
O	3452	3453	a
O	3454	3459	doubt
O	3459	3460	,
B-Fram	3461	3466	Redis
O	3467	3469	is
O	3470	3477	perfect
O	3478	3481	for
O	3482	3486	this
O	3487	3494	problem
O	3494	3495	.

O	3496	3498	It
O	3499	3507	requires
O	3508	3513	about
O	3514	3515	a
O	3516	3522	minute
O	3523	3525	to
O	3526	3531	setup
O	3532	3535	and
O	3536	3543	install
O	3543	3544	,
O	3545	3553	supports
O	3554	3560	atomic
O	3561	3571	increments
O	3571	3572	,
O	3573	3575	is
O	3576	3586	incredibly
O	3587	3591	fast
O	3591	3592	,
O	3593	3596	has
O	3597	3603	client
O	3604	3608	libs
O	3609	3612	for
B-PL	3613	3619	python
O	3620	3623	and
B-PL	3624	3627	php
O	3628	3629	(
O	3629	3632	and
O	3633	3637	many
O	3638	3643	other
O	3644	3653	languages
O	3653	3654	)
O	3654	3655	,
O	3656	3658	is
O	3659	3666	durable
O	3667	3668	(
O	3668	3677	snapshots
O	3677	3678	,
O	3679	3686	journal
O	3686	3687	,
O	3688	3699	replication
O	3699	3700	)
O	3700	3701	.

O	3702	3707	Store
O	3708	3712	each
O	3713	3720	counter
O	3721	3723	to
O	3724	3727	its
O	3728	3731	own
O	3732	3735	key
O	3735	3736	.

O	3737	3741	Then
O	3742	3748	simply
O	3749	3768	@codeSnippetRemoved
