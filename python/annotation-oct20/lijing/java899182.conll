Hibernate	B-Fram
calls	O
flush	O
on	O
find-	O
causes	O
not-null	O
error	O

I	O
have	O
a	O
process	O
which	O
updates	O
a	O
tree	O
to	O
the	O
database	O
,	O
and	O
in	O
doing	O
so	O
,	O
performs	O
reads	O
to	O
check	O
for	O
duplicates	O
entities	O
.	O

I'm	O
finding	O
that	O
trying	O
to	O
do	O
a	O
criteria.uniqueResult()	B-API
midway	O
through	O
this	O
process	O
causes	O
the	O
following	O
error	O
:	O

org.hibernate.PropertyValueException	B-API
:	O
not-null	O
property	O
references	O
a	O
null	O
or	O
transient	O
value	O

Digging	O
through	O
the	O
stack	O
trace	O
,	O
I	O
see	O
that	O
the	O
uniqueResult()	B-API
is	O
flushing	O
the	O
session	O
,	O
attempting	O
to	O
perform	O
updates	O
that	O
aren't	O
ready	O
to	O
go	O
to	O
the	O
database	O
yet	O
.	O

@codeSnippetRemoved	O

Have	O
I	O
set	O
something	O
up	O
wrong	O
here	O
?	O

Any	O
help	O
greatly	O
appreciated	O
.	O

Marty	O

Turn	O
off	O
auto-flushing	O
on	O
the	O
Session	O
object	O
to	O
fix	O
this	O
exception	O
.	O

@codeSnippetRemoved	O

This	O
is	O
not	O
your	O
error	O
however	O
.	O

Something	O
earlier	O
in	O
your	O
code	O
is	O
causing	O
the	O
in	O
memory	O
objects	O
to	O
be	O
in	O
an	O
invalid	O
state	O
which	O
is	O
trying	O
to	O
be	O
persisted	O
to	O
the	O
DB	O
during	O
the	O
autoflush	O
.	O

hibernate	B-Fram
remembers	O
with	O
objects	O
needs	O
to	O
be	O
saved	O
.	O
when	O
issuing	O
a	O
select	O
,	O
hibernate	B-Fram
will	O
flush	O
these	O
changes	O
.	O
this	O
ensures	O
the	O
select	O
will	O
return	O
the	O
correct	O
results	O
.	O

setting	O
flushmode	O
to	O
anything	O
else	O
than	O
FlushMode.AUTO	B-API
will	O
prevent	O
this	O
behaviour	O
.	O

But	O
the	O
error	O
is	O
in	O
your	O
code	O
,	O
where	O
you	O
pass	O
an	O
incomplete	O
object	O
to	O
hibernate	B-Fram
to	O
persist	O
or	O
update	O
.	O

So	O
the	O
correct	O
solution	O
is	O
to	O
pass	O
the	O
object	O
later	O
to	O
hibernate	B-Fram
,	O
when	O
it	O
is	O
complete	O
.	O

I've	O
pulled	O
my	O
hair	O
out	O
many	O
times	O
trying	O
to	O
get	O
to	O
the	O
bottom	O
of	O
these	O
issues	O
.	O

The	O
problem	O
being	O
that	O
it	O
'	O
s	O
so	O
difficult	O
to	O
get	O
to	O
the	O
root	O
of	O
the	O
issue	O
causing	O
it	O
.	O

If	O
you're	O
nearing	O
your	O
wits	O
end	O
you	O
can	O
also	O
execute	O
the	O
supporting	O
queries	O
such	O
as	O
findAll	O
in	O
a	O
new	O
session	O
:	O
@codeSnippetRemoved	O

That	O
has	O
usually	O
circumvented	O
the	O
problem	O
for	O
me	O
in	O
most	O
cases	O
.	O
