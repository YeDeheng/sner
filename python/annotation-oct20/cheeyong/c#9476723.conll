Failed	O
to	O
load	O
PDF	O
document	O

//	O
the	O
func	O
merges	O
the	O
src	O
pdf	O
with	O
the	O
memory	O
stream	O
,	O
wherein	O
the	O
stream	O
may	O
contain	O
//	O
few	O
othr	O
src	O
pdf	O
streams	O
in	O
previous	O
calls	O
to	O
this	O
func	O
//	O
in	O
first	O
cal	O
,	O
ms	O
would	O
be	O
nullpublic	O
static	O
void	O
MergePdf	B-API
(	O
MemoryStream	B-API
ms	O
,	O
string	O
srcFile	O
)	O
{	O
PdfReader	B-API
reader	O
=	O
new	O
PdfReader	B-API
(	O
srcFile	O
);	O
Document	O
document	O
=	O
null	O
;	O
PdfWriter	B-API
writer	O
=	O
null	O
;	O
int	O
n	O
=	O
reader.NumberOfPages	B-API
;	O
if	O
(	O
document	O
==	O
null	O
)	O
{	O
document	O
=	O
new	O
Document	O
(	O
reader.GetPageSizeWithRotation	B-API
(	O
1	O
));	O

writer	O
=	O
PdfWriter.GetInstance	B-API
(	O
document	O
,	O
ms	O
);	O

document.Open()	B-API
;	O
}	O
PdfContentByte	B-API
cb	O
=	O
writer.DirectContent	B-API
;	O
PdfImportedPage	B-API
page	O
;	O
int	O
rotation	O
;	O

int	O
i	O
=	O
0	O
;	O
while	O
(	O
i	O
n	O
)	O
{	O
i++	O
;	O
document.SetPageSize	B-API
(	O
reader.GetPageSizeWithRotation	B-API
(	O
i	O
));	O
document.NewPage()	B-API
;	O
page	O
=	O
writer.GetImportedPage	B-API
(	O
reader	O
,	O
i	O
);	O
rotation	O
=	O
reader.GetPageRotation	B-API
(	O
i	O
);	O
if	O
(	O
rotation	O
==	O
90	O
||	O
rotation	O
==	O
270	O
)	O
{	O
cb.AddTemplate	B-API
(	O
page	O
,	O
0	O
,	O
-1f	O
,	O
1f	O
,	O
0	O
,	O
0	O
,	O
reader.GetPageSizeWithRotation	B-API
(	O
i	O
)	O
.Height	O
);	O
}	O
else	O
{	O
cb.AddTemplate	B-API
(	O
page	O
,	O
1f	O
,	O
0	O
,	O
0	O
,	O
1f	O
,	O
0	O
,	O
0	O
);	O
}	O
}	O

}	O

I	O
write	O
the	O
Memory	O
stream	O
,	O
back	O
to	O
context.response.Outputstream	B-API
;	O
but	O
the	O
pdf	O
doesnt	O
load	O
,	O
the	O
page	O
'	O
Failed	O
to	O
load	O
Pdf	O
'	O
results	O
;	O
Is	O
there	O
any	O
problem	O
in	O
converting	O
btwn	O
memorystream	O
and	O
Pdf	O
contents	O
,	O
or	O
what	O
may	O
be	O
the	O
issue	O
?	O

I	O
had	O
the	O
same	O
problem	O
,	O
and	O
it	O
turned	O
out	O
that	O
the	O
cause	O
was	O
not	O
closing	O
the	O
document	O
,	O
and	O
adding	O
the	O
following	O
line	O
of	O
code	O
:	O
@codeSnippetRemoved	O

should	O
fix	O
the	O
problem	O
.	O
