Issue	O
with	O
substr	O
based	O
on	O
variable	O
MYSQL	O
IPN	O

Hello	O
I'm	O
having	O
trouble	O
trying	O
to	O
figure	O
out	O
why	O
I'm	O
getting	O
no	O
addition	O
to	O
my	O
username	O
column	O
within	O
my	O
table	O
.	O

I'm	O
trying	O
to	O
use	O
the	O
payer	O
email	O
within	O
my	O
IPN	O
to	O
introduce	O
a	O
username	O
for	O
login	O
.	O

Everything	O
is	O
being	O
posted	O
except	O
for	O
the	O
username	O
.	O

Is	O
there	O
something	O
I'm	O
doing	O
wrong	O
within	O
the	O
placement	O
of	O
the	O
username	O
variable	O
edits	O
?	O

Is	O
there	O
something	O
I'm	O
missing	O
that	O
is	O
preventing	O
this	O
from	O
being	O
posted	O
?	O

@codeSnippetRemoved	O

[	O
28-Jul-2013	O
16:05	O
:	O
40	O
America	O
/	O
Denver	O
]	O
PHP	B-PL
Parse	O
error	O
:	O
syntax	O
error	O
,	O
unexpected	O
T_ELSE	O
in	O
/	O
home	O
/	O
lear	O
/	O
public_html	O
/	O
storescripts	O
/	O
my_ipn.php	O
on	O
line	O
74	O
[	O
28-Jul-2013	O
21:06	O
:	O
37	O
America	O
/	O
Denver	O
]	O
PHP	B-PL
Warning	O
:	O
mysqli_query()	O
expects	O
parameter	O
1	O
to	O
be	O
mysqli	O
,	O
null	O
given	O
in	O
/	O
home	O
/	O
lear	O
/	O
public_html	O
/	O
storescripts	O
/	O
my_ipn.php	O
on	O
line	O
100	O
[	O
28-Jul-2013	O
21:06	O
:	O
37	O
America	O
/	O
Denver	O
]	O
PHP	B-PL
Warning	O
:	O
mysqli_num_rows()	O
expects	O
parameter	O
1	O
to	O
be	O
mysqli_result	O
,	O
null	O
given	O
in	O
/	O
home	O
/	O
lear	O
/	O
public_html	O
/	O
storescripts	O
/	O
my_ipn.php	O
on	O
line	O
102	O

Edit	O
:	O

I'vej	O
ust	O
updated	O
the	O
script	O
.	O

The	O
error	O
I'm	O
receiving	O
is	O
as	O
follows	O
:	O

[	O
28-Jul-2013	O
22:18	O
:	O
33	O
America	O
/	O
Denver	O
]	O
PHP	B-PL
Warning	O
:	O
mysqli_fetch_assoc()	O
expects	O
parameter	O
1	O
to	O
be	O
mysqli_result	O
,	O
null	O
given	O
in	O
/	O
home	O
/	O
learnsit	O
/	O
public_html	O
/	O
storescripts	O
/	O
my_ipn.php	O
on	O
line	O
108	O

Line	O
108	O
being	O

while	O
(	O
$name_arr	O
=	O
mysqli_fetch_assoc	O
(	O
$result	O
))	O
{	O

I	O
haven't	O
played	O
around	O
with	O
this	O
too	O
much	O
,	O
but	O
the	O
piece	O
of	O
code	O
which	O
stands	O
out	O
for	O
me	O
as	O
chiefly	O
suspect	O
is	O
:	O
@codeSnippetRemoved	O

It	O
should	O
probably	O
look	O
more	O
like	O
@codeSnippetRemoved	O

FYI	O
:	O
-	O
PHP	B-PL
can	O
handle	O
single	O
quotes	O
inside	O
of	O
double	O
quotes	O
without	O
needing	O
a	O
backslash	O
(	O
)	O
escape	O
.	O

-	O
You	O
don't	O
need	O
a	O
semicolon	O
(;	O
)	O
escape	O
for	O
a	O
MySQL	O
quote-	O
A	O
great	O
way	O
to	O
check	O
to	O
see	O
if	O
the	O
issue	O
is	O
in	O
fact	O
an	O
MySQL	O
query	O
for	O
your	O
future	O
debugging	O
is	O
to	O
add	O
or	O
die	O
(	O
mysql_error	O
(	O
$db	O
))	O
to	O
the	O
end	O
of	O
your	O
query	O
function	O
,	O
like	O
so	O
:	O
@codeSnippetRemoved	O

Hope	O
this	O
helps	O
!	O

Update	O
:	O

I've	O
added	O
this	O
to	O
the	O
result	O
area	O
to	O
try	O
and	O
debug	O
,	O
but	O
I'm	O
not	O
receiving	O
anything	O
from	O
it	O
.	O

Would	O
this	O
come	O
up	O
in	O
your	O
standard	O
error	O
page	O
?	O

Try	O
@codeSnippetRemoved	O

After	O
looking	O
even	O
further	O
at	O
your	O
code	O
it	O
looks	O
like	O
you	O
shouldn't	O
see	O
anything	O
for	O
username	O
=	O
'	O
{$username}	O
'	O
,	O
because	O
$username	O
is	O
being	O
based	O
off	O
of	O
$payer_email	O
,	O
which	O
has	O
not	O
been	O
declared	O
yet	O
.	O

You'll	O
need	O
to	O
either	O
put	O
those	O
username	O
checks	O
into	O
a	O
function	O
and	O
call	O
it	O
after	O
you've	O
assigned	O
variables	O
the	O
$_POST	O
index	O
,	O
or	O
move	O
the	O
$_POST[	O
"	O
payer_email	O
"	O
]	O
to	O
before	O
you	O
first	O
declare	O
the	O
$username	O
variable	O
,	O
as	O
well	O
as	O
getting	O
rid	O
of	O
the	O
$_POST[	O
"	O
username	O
"	O
]	O
...	O

Although	O
I	O
haven't	O
seen	O
your	O
form	O
it	O
sounds	O
like	O
you're	O
creating	O
the	O
username	O
through	O
the	O
payer	O
email	O
.	O

Does	O
this	O
help	O
more	O
?	O

Update	O
2	O
:	O

Your	O
error	O
with	O
mysql_fetch_assoc	O
is	O
because	O
you	O
haven't	O
declared	O
$result	O
.	O

I	O
believe	O
you	O
may	O
be	O
trying	O
to	O
refer	O
to	O
$user_query	O
,	O
in	O
which	O
case	O
your	O
line	O
108	O
should	O
be	O
:	O
@codeSnippetRemoved	O

Update	O
3	O
:	O
@codeSnippetRemoved	O

First	O
of	O
all	O
I	O
notice	O
you're	O
using	O
username	O
=	O
'	O
{$username}%	O
'	O
.	O

I	O
have	O
a	O
handful	O
of	O
points	O
to	O
make	O
and	O
I	O
hope	O
you	O
listen	O
to	O
them	O
.	O

I'm	O
giving	O
you	O
fish	O
here	O
but	O
I'd	O
like	O
to	O
teach	O
you	O
as	O
well	O
.	O

If	O
you	O
want	O
to	O
do	O
a	O
comparison	O
,	O
it	O
'	O
s	O
going	O
to	O
have	O
to	O
be	O
username	O
LIKE	O
'	O
{$username}%	O
'	O
I	O
wasn't	O
clear	O
about	O
what	O
you	O
were	O
trying	O
to	O
do	O
...	O

If	O
you	O
want	O
a	O
unique	O
identifier	O
,	O
I'd	O
actually	O
do	O
something	O
more	O
like	O
username=	O
'	O
{$username}	O
'	O
,	O
and	O
then	O
,	O
if	O
it	O
returns	O
a	O
single	O
result	O
,	O
add	O
a	O
unique	O
identifier	O
to	O
the	O
end	O
.	O

You	O
see	O
,	O
when	O
you	O
do	O
something	O
with	O
LIKE	O
{$username}%	O
,	O
you're	O
going	O
to	O
end	O
up	O
getting	O
two	O
rows	O
if	O
someone	O
is	O
trying	O
to	O
sign	O
up	O
as	O
awesome_bob	O
,	O
when	O
someone	O
else	O
already	O
has	O
awesome_bobby	O
.	O

You're	O
going	O
to	O
want	O
something	O
more	O
random	O
,	O
I	O
would	O
think	O
,	O
or	O
to	O
create	O
a	O
more	O
complicated	O
function	O
.	O

Or	O
,	O
just	O
keep	O
username	O
as	O
e-mail	O
,	O
which	O
keeps	O
it	O
unique	O
and	O
is	O
a	O
very	O
simple	O
fix	O
.	O

I'm	O
going	O
to	O
leave	O
this	O
post	O
at	O
that	O
because	O
I	O
think	O
it	O
has	O
answered	O
your	O
initial	O
question	O
and	O
then	O
some	O
.	O

If	O
you	O
have	O
further	O
questions	O
,	O
I	O
think	O
people	O
would	O
be	O
happy	O
to	O
look	O
at	O
them	O
in	O
a	O
separate	O
topic	O
.	O

Have	O
I	O
answered	O
your	O
question	O
enough	O
?	O

If	O
so	O
I	O
would	O
appreciate	O
a	O
+1	O
for	O
my	O
effort	O
:)	O
