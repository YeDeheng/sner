Using	O
SetForegroundWindow	B-API
to	O
focus	O
on	O
a	O
window	O

var	O
hwnd	O
=	O
GetWindowHandle()	B-API
;	O
//	O
Custom	O
function	O
that	O
returns	O
the	O
target	O
window	O
'	O
s	O
handle	O
var	O
currentThreadId	O
=	O
GetCurrentThreadId()	B-API
;	O
uint	O
pid	O
;	O
var	O
targetThreadId	O
=	O
GetWindowThreadProcessId	B-API
(	O
hwnd	O
,	O
out	O
pid	O
);	O
if	O
(	O
targetThreadId	O
==	O
IntPtr.Zero	B-API
)	O
return	O
;	O
if	O
(	O
targetThreadId	O
!	O
=	O
currentThreadId	O
)	O
{	O
AttachThreadInput	B-API
(	O
currentThreadId	O
,	O
targetThreadId	O
,	O
true	O
);	O
}	O
SetForegroundWindow	B-API
(	O
hwnd	O
);	O
if	O
(	O
currentThreadId	O
!	O
=	O
targetThreadId	O
)	O
{	O
AttachThreadInput	B-API
(	O
currentThreadId	O
,	O
targetThreadId	O
,	O
false	O
);	O
}	O

I	O
have	O
used	O
the	O
above	O
code	O
to	O
put	O
focus	O
to	O
another	O
window	O
,	O
using	O
the	O
Handle	O
of	O
the	O
targeted	O
window	O
.	O

The	O
above	O
code	O
is	O
placed	O
inside	O
a	O
method	O
which	O
is	O
called	O
when	O
a	O
shortcut	O
key	O
is	O
pressed.The	B-API
issue	O
that	O
I	O
am	O
facing	O
is	O
that	O
for	O
the	O
first	O
time	O
focus	O
is	O
getting	O
stuck	O
at	O
the	O
window	O
,	O
i.e.	O
,	O
the	O
focus	O
is	O
not	O
shifting	O
to	O
other	O
controls	O
in	O
the	O
window	O
(	O
on	O
tab	O
press	O
)	O
.	O

So	O
I	O
have	O
to	O
bring	O
the	O
focus	O
inside	O
the	O
window	O
,	O
using	O
mouse	O
.	O

On	O
pressing	O
the	O
shortcut	O
for	O
the	O
2nd	O
time	O
,	O
the	O
focus	O
is	O
not	O
getting	O
stuck	O
anymore	O
,	O
its	O
moving	O
correctly	O
on	O
tab	O
press.Also	B-API
please	O
note	O
that	O
I	O
have	O
tried	O
using	O
SetFocus	B-API
,	O
but	O
I	O
am	O
getting	O
the	O
same	O
issue	O
.	O

Please	O
suggest	O
of	O
there	O
is	O
anything	O
wrong	O
with	O
the	O
code	O
,	O
or	O
if	O
I	O
can	O
use	O
any	O
alternate	O
method	O
to	O
achieve	O
the	O
same	O
behavior	O
.	O

Thanks	O
.	O
